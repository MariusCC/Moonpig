
heartbeat:
  why    : sent frequently and without cause to at least every ledger
  sent to: all kinds of stuff
  sent by: [externally generated]
  known handlers:
    Consumer/ByTime: charge
    Consumer/WithExpirationDate: check_expiry
    Ledger: redistribute → _reheartbeat

activated:
  sent to: consumer
  sent by: itself
  why: consumer is activated for the first time
  known handlers:
    consumer: noop

cancel:
  sent to: consumer
  sent by: itself
  why: service is beiing cancelled externally
  known handlers:
    consumer: cancel_service

contact-humans:
  why    : to send message to ledger's contact
  args   : message
  sent to: ledgers
  sent by: -
  known handlers:
    Ledger: default ⇒ missing

consumer-create-replacement:
  why    : tells a consumer to set up its replacement
  args   : 
    mri: replacement MRI
  sent to: consumer
  sent by: itself
  known handlers:
    Consumer: create_replacement → create_own_replacement

created:
  sent to: ledger components
  sent by: ledger
  why    : on creation
  known handlers:
    LedgerComponent: created ⇒ noop
    Consumer/ByTime: initial-invoice → _invoice

fail-over:
  sent to: consumer
  sent by: itself
  why: just before expiration, when a replacement is available
  known handlers:
    Consumer: default → 'failover'
  see also:
    - terminate-service

paid:
  sent to: invoice
  sent by: ledger
  why: when the invoice is paid
  known handlers:
    Invoice: create_banks → _bank_credit

queue-email:
  sent to: environment
  sent by: ledger 
  why: ledger wants to send email
  args:
    email: message body
    env: { to => $to, from => $from }
  known handlers:
    Env: default → handle_queue_email

send-mkit:
  sent to: ledger
  sent by: dunner
  why: to deliver a request for payment
  args: (passed to $kil->assemble method
  known handlers:
    Ledger: default → _send_mkit

terminate-service:
  sent to: consumer
  sent by: itself
  why: just before expiration, when no replacement is available
  known handlers:
    consumer: default → terminate_service
  see also:
    - fail-over

